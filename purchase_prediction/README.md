# Предсказание покупок

Проект посвящён разработке модели, которая предсказывает вероятность покупки клиентом в течение 90 дней после рассылки маркетинговых сообщений. Цель — повысить точность таргетинга и улучшить эффективность маркетинговых кампаний.

---

## Цели исследования

- Изучить данные о покупках и действиях клиентов.  
- Создать полезные признаки на основе поведения покупателей.  
- Обработать категориальные, числовые и временные признаки.  
- Обучить модели классификации для предсказания вероятности покупки.  
- Достичь высокой метрики **ROC‑AUC** и выбрать лучшую модель.  

---

## Данные

Используются три датасета:

### **apparel-purchases**  
Данные о покупках клиентов после получения рассылок:  
- client_id  
- date  
- price  
- quantity  
- category_ids  
- message_id  

### **apparel-messages**  
Информация о рассылках:  
- client_id  
- message_id  
- bulk_campaign_id  
- channel  
- event  
- date  
- created_at  

### **target**  
Содержит ответ:  
- client_id  
- target (покупка в течение 90 дней)

---

## Предобработка данных

Проведены ключевые шаги:

### 1. Очистка данных
- удалены дубликаты;  
- устранены пропуски в категориальных признаках;  
- удалён столбец `date_msg` — дублирует `created_at`.

### 2. Обработка числовых признаков
- найдены выбросы по цене и количеству;  
- выбросы удалены (меньше 1% строк);  
- признак `quantity` удалён как нерелевантный после анализа.

### 3. Обработка категориальных признаков
- разбор **category_ids** → создание бинарных признаков: cat_4, cat_27, …  
- признак **message_id** исключён (сильно связан со временем рассылки).  
- признак **bulk_campaign_id** исключён — модель должна быть независимой от id кампании.

### 4. Работа с временными признаками
- анализ активности по дням недели и месяцам;  
- признаки даты сообщения удалены, т.к. **сильно коррелируют с датой покупки**.

---

## Исследовательский анализ данных (EDA)

Основные наблюдения:

### Числовые признаки
- выбросы в цене и количестве удалены;  
- клиенты чаще совершают покупки в дешёвом сегменте товаров.

### Категориальные признаки
- категории товаров сильно коррелируют между собой;  
- слабая корреляция с целевым признаком — но некоторые категории всё же полезны.

### Временные признаки
- самые активные дни покупок: **пятница**, затем среда и четверг;  
- активные месяцы: **июнь, ноябрь, декабрь**.

---

## Корреляционный анализ

- сильной корреляции с target нет;  
- корреляция channel–price ≈ 0.21;  
- проанализированы первые 20 категорий товаров;  
- отобраны признаки с корреляцией > 1%;  
- признаки с высоким **VIF** (мультиколлинеарность) удалены.

---

## Обучение моделей

Обучены модели:

- Logistic Regression  
- CatBoostClassifier  
- LightGBMClassifier  
- RandomForestClassifier  

### Лучшие результаты:
- **CatBoostClassifier — ROC‑AUC = 0.8712**  
- LightGBM немного хуже  
- Logistic Regression заметно уступает по качеству

CatBoost выбран как финальная модель.

---

## Важность признаков

Наиболее значимые признаки:

1. **price** — низкая цена → выше вероятность покупки  
2. **created_at** — время создания сообщения  
3. **channel** — тип канала влияет на поведение клиента  
4. **event** — тип взаимодействия с рассылкой  
5. **категории товаров**

Модель корректно определяет влияние текстов рассылок и поведения клиентов на вероятность покупки.

---

## Общий вывод

- Проведена очистка и объединение данных из трёх источников.  
- Разработаны новые категориальные и поведенческие признаки.  
- Выявлены ключевые факторы, влияющие на отклики на email‑рассылки.  
- Обучены несколько моделей, лучшая — CatBoost (ROC‑AUC 0.8712).  
- Модель может использоваться для персонализации маркетинговых рассылок и увеличения конверсии.

---

## Используемый стек

- Python  
- pandas, NumPy  
- matplotlib, seaborn  
- scikit-learn  
- CatBoost, LightGBM  
- методы работы с датами и категориальными признаками  

