# Прогнозирование заказов такси

Проект посвящён разработке модели, которая прогнозирует количество заказов такси на следующий час на основе исторических данных.  
Цель — помочь сервису оптимизировать количество автомобилей в разных районах и повысить качество обслуживания.

---

## Цели исследования

- Изучить временной ряд заказов такси.  
- Выполнить ресемплирование данных.  
- Провести анализ тренда, сезонности и шума.  
- Подготовить признаки (лаговые переменные, скользящее среднее).  
- Обучить несколько моделей временных рядов.  
- Выбрать модель с RMSE **не выше 48** на тестовой выборке.  

---

## Данные

Имеются исторические данные о количестве заказов:

- **datetime** — временная метка (с шагом 1 час)  
- **num_orders** — количество заказов такси за соответствующий час  

### Особенности данных:
- временной ряд без пропусков;  
- отсортирован по времени;  
- присутствуют реальные пики спроса (вечер, выходные);  
- ярко выраженная недельная сезонность.

---

## Предобработка данных

Основные шаги:

- преобразование индекса к формату datetime;  
- ресемплирование в часовой интервал (при необходимости);  
- проверка на пропуски и аномалии;  
- создание новых признаков:
  - лаги: `lag_1`, `lag_2`, `lag_24`, …  
  - скользящее среднее: `rolling_mean_3`, `rolling_mean_6`, `rolling_mean_24`;  
  - признаки даты: час, день недели, месяц.

---

## Исследовательский анализ данных (EDA)

### Тренд
- на графике виден плавный рост количества заказов с течением времени.

### Сезонность
- ярко выражена **суточная сезонность** (пики вечером);  
- **недельная сезонность** — больше заказов по пятницам и выходным.

### Шум
- присутствуют резкие скачки (праздники, предпраздничные дни).  

### Вывод ЕDA
- ряд является стационарным после добавления лаговых признаков;  
- можно использовать ML‑подходы.

---

## Обучение моделей

Использованы следующие модели:

- **LinearRegression**  
- **RandomForestRegressor**  
- **LightGBMRegressor**  
- **CatBoostRegressor**

### Подготовка данных:
- разбиение на train/test по времени;  
- масштабирование числовых признаков при необходимости;  
- обучение с подбором гиперпараметров.  

---

## Результаты

### Лучшие результаты показала модель:
## **LightGBMRegressor**

- RMSE на тесте: **≈ 41**  
- Удовлетворяет требованию RMSE ≤ 48.  
- Даёт устойчивые предсказания на пиках спроса.  

CatBoost также показал хорошее качество, но был медленнее.

---

## Основные выводы

- Проведён анализ временного ряда с выявлением трендов и сезонности.  
- Созданы эффективные лаговые признаки и скользящие средние.  
- Обучены несколько моделей машинного обучения.  
- Лучшая модель — **LightGBM**, RMSE ≈ 41.  
- Модель подходит для применения в системе распределения такси.

---

## Используемый стек

- Python  
- pandas, NumPy  
- matplotlib, seaborn  
- scikit-learn  
- LightGBM, CatBoost  

