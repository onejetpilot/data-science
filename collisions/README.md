# Предсказание ДТП

Проект посвящён созданию модели, которая предсказывает вероятность дорожно‑транспортного происшествия по данным о столкновениях, участниках и транспортных средствах. Цель — разработать систему оценки риска ДТП, способную анализировать различные факторы и помогать в принятии решений.

---

## Цели исследования
- Изучить структуру данных и таблицы: collisions, parties, vehicles, phone_collisions и др.
- Провести первичное исследование данных, выявить пропуски, аномалии и несостыковки.
- Подготовить данные: объединить таблицы, обработать категориальные признаки, создать новые признаки.
- Выполнить разведочный анализ данных (EDA) и определить ключевые факторы риска.
- Обучить несколько моделей классификации и сравнить их качество.
- Выбрать модель с наилучшим значением метрики (F1/ROC-AUC).
- Сформировать общий вывод о применимости модели.

---

## Данные

Используются таблицы:

### **collisions** — информация о ДТП
- case_id — уникальный идентификатор происшествия  
- дата, время, погодные условия  
- место происшествия  
- факторы, повлиявшие на столкновение  

### **parties** — данные об участниках
- case_id  
- party_number  
- демографические данные  
- роль в ДТП  
- факторы поведения  

### **vehicles** — характеристики транспортных средств
- vehicle_id  
- тип ТС  
- возраст  
- повреждения  
- дорожные условия  

### **phone_collisions** — факты использования телефона
- использование телефона водителем  
- условия управления  
- сопутствующие факторы  

Данные содержат пропуски, неявные аномалии и категориальные признаки, требующие кодирования.

---

## Предобработка данных

Выполненные шаги:

- Приведение типов данных (даты, числа, категориальные признаки).
- Обнаружение и удаление дубликатов.
- Коррекция пропусков:
  - категориальные признаки — заполнение модой,
  - числовые — медианой или заменой некорректных значений.
- Объединение таблиц по ключам (`case_id`, `party_number`, `vehicle_id`).
- Удаление технических и нерелевантных столбцов.
- Кодирование категориальных признаков (One-Hot / Ordinal Encoding).
- Балансировка классов (если применялась — например, RandomUnderSampler / SMOTE).

---

## Исследовательский анализ данных (EDA)

Основные шаги:

- Проверка распределений признаков.
- Анализ корреляций между характеристиками участников, автомобилей и исходом ДТП.
- Выделение факторов риска:
  - возраст водителя,
  - использование телефона,
  - погодные условия,
  - тип транспортного средства,
  - время суток,
  - нарушения ПДД.
- Выявление мультиколлинеарности среди категориальных признаков.
- Построение графиков:
  - гистограммы и boxplot'ы,
  - распределение целевого признака,
  - сравнение групп (участник использовал телефон / нет).

---

## Моделирование

Обучены несколько моделей классификации:

- Logistic Regression
- Random Forest
- Gradient Boosting (CatBoost / LightGBM)
- XGBoost
- Baseline-модель для сравнения

### Подготовка данных:
- деление на train/test,
- масштабирование числовых признаков (где требуется),
- кодирование категориальных.

### Оценка моделей:
- F1-score  
- ROC-AUC  
- Accuracy  
- Precision/Recall  

---

## Результаты

- Модели на основе градиентного бустинга (CatBoost / LightGBM) показали наилучший баланс качества и скорости.
- Линейные модели продемонстрировали более низкое качество на сложных нелинейных зависимостях.
- Random Forest показал высокое качество, но был медленнее.

### Итог:
**Лучшая модель — градиентный бустинг (CatBoost / LightGBM)**.

---

## Важность признаков

К ключевым факторам риска относятся:

1. использование телефона водителем;  
2. возраст водителя;  
3. опыт вождения;  
4. погодные условия;  
5. тип транспортного средства;  
6. нарушения ПДД;  
7. время суток.

Эти признаки оказывают наибольшее влияние на вероятность ДТП.

---

## Основные выводы

- Данные из нескольких таблиц успешно объединены и очищены.
- Проведён глубокий EDA, выявивший ключевые закономерности.
- Обучены и сравнены несколько моделей классификации.
- Лучшая модель продемонстрировала высокое качество и устойчивость.
- Основные факторы риска ДТП определены и интерпретируемы.
- Полученная модель может использоваться в системах предиктивной аналитики для оценки вероятности ДТП.

---

## Используемый стек

- Python  
- pandas, NumPy  
- matplotlib, seaborn  
- scikit-learn  
- CatBoost / LightGBM  
- SQLite / CSV  

