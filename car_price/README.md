# Определение стоимости автомобилей

Проект посвящён разработке модели, которая по характеристикам подержанного автомобиля предсказывает его рыночную стоимость.  
Модель разрабатывается для сервиса продажи автомобилей «Не бит, не крашен» и должна быть достаточно точной и быстрой для использования в продакшене.

---

## Цели исследования

- Проанализировать исходные данные об автомобилях и их ценах.  
- Выявить ошибки, выбросы и аномалии в данных и скорректировать их.  
- Подготовить признаки для обучения моделей: числовые и категориальные.  
- Обучить и сравнить несколько моделей регрессии по качеству и скорости:  
  - качество предсказания (RMSE),  
  - время обучения,  
  - время предсказания.  
- Выбрать модель, удовлетворяющую условию: **RMSE < 2500**.  

---

## Данные

Данные находятся в файле **`autos.csv`**.  
Каждая строка — отдельное объявление о продаже автомобиля.

Основные признаки:

- `price` — цена (евро), целевой признак;  
- `vehicle_type` — тип кузова;  
- `registration_year` — год регистрации автомобиля;  
- `gearbox` — тип коробки передач;  
- `power` — мощность (л.с.);  
- `model` — модель;  
- `kilometer` — пробег (км);  
- `registration_month` — месяц регистрации;  
- `fuel_type` — тип топлива;  
- `brand` — марка;  
- `repaired` — состояние (были/не были в ремонте);  
- `date_crawled`, `date_created`, `last_seen` — временные признаки, связанные с обработкой и жизненным циклом объявления;  
- `number_of_pictures` — количество фотографий;  
- `postal_code` — почтовый индекс.

В исходных данных обнаружены пропуски, подозрительные значения и аномалии (например, цена = 0, некорректный год регистрации, нулевая мощность и др.).

---

## Используемый стек

- **Python** — основной язык разработки  
- **pandas** — загрузка и обработка данных  
- **NumPy** — численные операции и работа с массивами  
- **matplotlib**, **seaborn** — визуализация распределений и зависимостей  
- **scikit-learn** — базовые модели, разбиение выборки, метрики (RMSE), предобработка признаков  
- **LightGBM** — градиентный бустинг по деревьям с фокусом на скорость  
- **CatBoost** — градиентный бустинг с поддержкой категориальных признаков  

---

## Основные выводы

- Исходные данные содержали ошибки, выбросы и некорректные значения, которые были выявлены и устранены.  
- После предобработки сформирован адекватный набор признаков, отражающий реальные характеристики автомобиля и его состояние.  
- Анализ показал, что ключевыми факторами цены являются год регистрации, мощность, пробег, марка, модель и состояние ремонта.  
- Сравнение нескольких моделей продемонстрировало, что линейная регрессия не подходит по качеству, а случайный лес — по времени работы.  
- Градиентный бустинг (LightGBM, CatBoost) показал наилучшее сочетание качества и скорости.  
- В качестве финального решения выбрана модель **CatBoostRegressor**, обеспечивающая **RMSE значительно ниже 2500** и подходящая для использования в сервисе оценки стоимости подержанных автомобилей.

